<!DOCTYPE html>
<html>
  <head>
    <title>Compile CoffeeScript</title>
  </head>
  <body>
    <!-- this div will receive dropped files to compile -->
    <div id="holder" style="background-color:#ccc;color:#777;padding:10px">Drop coffee file here</div>
    <div style="background-color:#eee;color:#444">
      <pre id="result" style="padding:10px"></pre>
    </div>
    <script type="text/javascript" src="coffee-script-1.3.3.min.js"></script>
    <script type="text/javascript">
    (function() {
      var holder = document.getElementById('holder')
      var result = document.getElementById('result')

      holder.ondrop = function(e) {
        e.preventDefault()
        var file = e.dataTransfer.files[0]
        var reader = new FileReader()
        reader.onload = function(event) {
          if (file.name.lastIndexOf('.coffee') === file.name.length-7)
            result.textContent = CoffeeScript.compile(event.target.result)
          else
            result.innerHTML = 'Please insert a coffeescript file'
        }
        reader.onerror = function() {
          result.innerHTML = 'Unable to read ' + file.name
        }
        reader.readAsText(file)
        return false
      }
    })()
    </script>
  </body>
</html>
